<!DOCTYPE html><meta content="width=device-width" name=viewport><meta content="一小段代码" name=description><link href=/bundle.css rel=stylesheet><link href=/favicon.ico rel="shortcut icon"><link href=/favicon.svg rel=icon><script src=/bundle.js defer></script><script src=/check.js async></script><title>在批处理中延时(等待) - kkocdko's blog</title><main><article class=card><h1 id=在批处理中延时等待>在批处理中延时(等待)</h1><ul><li>众所周知，在旧版本Windows中，批处理并不原生支持延时。新版本Windows中的<code>timeout</code>延时不够精细。</li></ul><h3 id=code>Code</h3><pre><code class=language-batch>echo CreateObject(&quot;scripting.filesystemobject&quot;).deletefile(WScript.scriptfullname):WScript.sleep WScript.Arguments(0)&gt;%Temp%\SleepScript.vbs
start /wait %Temp%\SleepScript.vbs &lt;DelayTime&gt;</code></pre><ul><li>其中<code>&lt;DelayTime&gt;</code>为要延时的毫秒数。</li></ul><h3 id=update-history>Update History</h3><h4 id=20180713>20180713</h4><ul><li>精简代码。</li></ul><h4 id=20180401>20180401</h4><ul><li>首个版本。</li></ul></article></main><header class=in></header>