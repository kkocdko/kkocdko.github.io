<!DOCTYPE html><html><head><meta content="width=device-width" name=viewport><link href=/bundle.css rel=stylesheet><script src=/bundle.js defer></script><script src=/check.js async></script><link href=/favicon.ico rel="shortcut icon"><link href=/favicon.svg rel=icon><title>让批处理以管理员权限运行 - kkocdko's blog</title><meta content="目前已知最好解决方案" name=description><meta content=rgb(63,81,181) name=theme-color></head><body><main><article class=card><h1 id=让批处理以管理员权限运行>让批处理以管理员权限运行</h1><h3 id=code>Code</h3><pre><code class=language-batch>fltmc&gt;nul||mshta vbscript:CreateObject(&quot;Shell.Application&quot;).ShellExecute(&quot;%~dpnx0&quot;,&quot;%*&quot;,,&quot;runas&quot;,1)(window.close)&amp;&amp;exit</code></pre><ul><li>在<strong>开头</strong>添加这些代码，批处理就会在运行时申请提权。</li></ul><h3 id=instruction>Instruction</h3><ul><li><p>仅一行代码。</p></li><li><p>无需写入临时文件。</p></li><li><p>有传入参数时，也能得到管理员权限。且提权不会丢失参数。</p></li><li><p>在<code>xp ~ 10</code>上测试正常。不支持部分极限精简的WinPE。</p></li></ul><h3 id=update-history>Update History</h3><h4 id=20190524>20190524</h4><ul><li>修复只能传递第一个参数的bug。</li></ul><h4 id=20190221>20190221</h4><ul><li>一点改进，不切换当前目录。</li></ul><h4 id=20181109>20181109</h4><ul><li>一点改进，使得批处理被传参时也能提权。</li></ul><h4 id=20180401>20180401</h4><ul><li>首个版本。</li></ul></article></main><header class=in id=extra></header></body></html>