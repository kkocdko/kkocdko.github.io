<!DOCTYPE html><meta content="width=device-width" name=viewport><link href=/bundle.css rel=stylesheet><script src=/bundle.js defer></script><script src=/check.js async></script><link href=/favicon.ico rel="shortcut icon"><link href=/favicon.svg rel=icon><title>最大限度压缩文档扫描件 - kkocdko's blog</title><meta content="也适用于其他颜色单调的图片" name=description><main><article class=card><h1 id=最大限度压缩文档扫描件>最大限度压缩文档扫描件</h1><h3 id=foreword>Foreword</h3><p>事实上，这个标题描述得并不准确。计算机领域的“压缩”是一个<code>NP-Hard</code>问题，我们无法把一个文件压缩到最小，也无从知晓这个文件是不是最小。</p><h3 id=postulate>Postulate</h3><ul><li><p><a href=https://pngquant.org>pngquant</a>（用于PNG精准靠色）。</p></li><li><p><a href=https://github.com/google/zopfli>zopflipng</a>（用于PNG高质量压缩）。</p></li></ul><h4 id=optional>Optional</h4><ul><li><p><a href=http://optipng.sourceforge.net>optipng</a>（用于将图片转换为PNG）。</p></li><li><p><a href=https://www.adobe.com/photoshop>Photoshop</a>（用于批量调整图片，例如切边/调整对比度）（请支持正版（如果你有足够多钱））。</p></li><li><p><a href=https://github.com/kkocdko/UniversalGUI>UniversalGUI</a>（用于自动输入命令以及提升CPU利用率，在大量处理图片的时候很有用）。</p></li></ul><h3 id=step-1-optional>Step 1 (Optional)</h3><p>使用<code>photoshop</code>调整页面。根据需要调整对比度，切除无用部分。</p><ul><li>可以使用“批处理”功能来批量调整图片。</li></ul><h3 id=step-2-optional>Step 2 (Optional)</h3><p>如果源文件不是PNG格式，请使用<code>optipng</code>将图片转换为PNG。这里给出推荐的参数：</p><pre><code>optipng -o 0 -zc 1 -out {OutputFile} {InputFile}</code></pre><h3 id=step-3>Step 3</h3><p>使用<code>pngquant</code>对PNG文件进行靠色。这里给出推荐的参数：</p><p>对于黑白/灰度扫描件：</p><pre><code>pngquant --speed 1 --quality 0-1 --posterize 4 --nofs 4 -o {OutputFile} {InputFile}</code></pre><p>对于彩色扫描件：</p><pre><code>pngquant --speed 1 --quality 0-60 --nofs 256 -o {OutputFile} {InputFile}</code></pre><ul><li><p>最后一个数字为最大颜色数量，针对灰度扫描件推荐设置64以下，黑白扫描件推荐设置4以下。</p></li><li><p>如果发现靠色后的文件背景偏色，请将压缩后的图像使用Photoshop替换颜色，接着重复<a href=#step-3>Step 3</a>。</p></li></ul><h3 id=step-4>Step 4</h3><p>使用<code>zopflipng</code>对PNG文件进行极限压缩。这里给出推荐的参数：</p><pre><code>zopflipng -m {InputFile} {OutputFile}</code></pre><ul><li>将耗费较多算力。</li></ul><h3 id=postscript>Postscript</h3><ul><li><p><a href=https://github.com/google/zopfli>zopflipng</a>需要自行编译，如果你手头不方便，可以<a href=https://pan.baidu.com/s/1yWoWmxJAw8dLoBHSTCi8bg>https://pan.baidu.com/s/1yWoWmxJAw8dLoBHSTCi8bg</a>（windows only）。</p></li><li><p>在将图片添加到PDF或其他格式文档中时，记得不要进行二次压缩。</p></li></ul></article></main><header class=in id=extra></header>